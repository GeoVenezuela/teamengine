<?xml version="1.0" encoding="UTF-8"?>
<ctl:package
 xmlns="http://www.occamlab.com/ctl"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ctl="http://www.occamlab.com/ctl"
 xmlns:parsers="http://www.occamlab.com/te/parsers"
 xmlns:myparsers="http://teamengine.sourceforge.net/parsers"
 xmlns:saxon="http://saxon.sf.net/"
 xmlns:csw="http://www.opengis.net/cat/csw"
 xmlns:gml="http://www.opengis.net/gml"
 xmlns:ogc="http://www.opengis.net/ogc"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xsd="http://www.w3.org/2001/XMLSchema"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://www.occamlab.com/ctl ../../../../../apps/engine/resources/com/occamlab/te/schemas/ctl.xsd">

	<test name="csw:discovery.csw.getrecords.8">
      <param name="csw.GetRecords.post.url"/>
      <assertion>If the DistributedSearch parameter is false, or not specified, then it is run locally.  Otherwise it is run using the hopCount parameter (limiting the maximum number of hops, decremented by each server, not propagating if the count is 0).</assertion>
      <comment>This test issues a GetRecords requests using HTTP POST to the CSW server under test. The hopCount is set to '3' and it is expected to <!--TODO: finish this...-->.</comment>
      <link>OGC 04-021r3, 10.8.4.11, p. 137</link>
		<code>
		
			<xsl:variable name="request1">
				<request>
					<url>
						<xsl:value-of select="$csw.GetRecords.post.url"/>
					</url>
					<method>post</method>
					<body><![CDATA[
<csw:GetRecords resultType="results" outputSchema="http://www.opengis.net/cat/csw" xmlns:csw="http://www.opengis.net/cat/csw" xmlns:gml="http://www.opengis.net/gml" xmlns:ogc="http://www.opengis.net/ogc">
	<csw:DistributedSearch hopCount="3"/>
	<csw:Query typeName="csw:Record"/>
</csw:GetRecords>
					]]></body>
					<!--<myparsers:XMLValidatingParser.CSW/>-->
				</request>
			</xsl:variable>	
			
			<xsl:if test="not($request1/*)">
				<ctl:fail/>
			</xsl:if>

			<!--TODO: How to check for this?-->	
			<!--<xsl:if test="$request1/*">						
				
			</xsl:if>-->
				
		</code>
	</test>
</ctl:package>
